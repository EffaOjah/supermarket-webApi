<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<title>MaryBill Conglomerate Ltd. - Profit & Loss</title>
	<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no' name='viewport' />
	<link rel="stylesheet" href="/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i">
	<script src="https://kit.fontawesome.com/a207e207d8.js" crossorigin="anonymous"></script>
	<link rel="stylesheet" href="/css/ready.css">
	<link rel="stylesheet" href="/css/demo.css">
	<link rel="icon" type="image/x-icon" href="/img/app_icon.ico">
	<link rel="stylesheet" href="/iziToast-master/dist/css/iziToast.min.css">
	<style>
		.pl-card { box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08); border-radius: 12px; border: none; margin-bottom: 1.5rem; }
		.card-header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 12px 12px 0 0 !important; padding: 1.5rem; }
		.card-header .card-title { color: white; font-weight: 700; font-size: 1.25rem; margin: 0; }
		.section-header { background: linear-gradient(135deg, #edf2f7 0%, #e2e8f0 100%); padding: 1rem 1.5rem; font-weight: 700; font-size: 1.1rem; border-radius: 8px; margin-bottom: 1rem; }
		.section-header.revenue { background: linear-gradient(135deg, #c6f6d5 0%, #9ae6b4 100%); color: #22543d; }
		.section-header.cogs { background: linear-gradient(135deg, #feebc8 0%, #fbd38d 100%); color: #744210; }
		.section-header.expenses { background: linear-gradient(135deg, #fed7d7 0%, #feb2b2 100%); color: #742a2a; }
		.account-row { padding: 0.75rem 1.5rem; border-bottom: 1px solid #e2e8f0; display: flex; justify-content: space-between; align-items: center; transition: all 0.2s; }
		.account-row:hover { background: #f7fafc; transform: translateX(5px); }
		.account-row:last-child { border-bottom: none; }
		.account-name { font-weight: 500; color: #2d3748; }
		.account-code { color: #718096; font-size: 0.875rem; margin-left: 0.5rem; }
		.account-amount { font-weight: 600; color: #2d3748; font-size: 1.1rem; }
		.subtotal-row { background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%); padding: 1rem 1.5rem; font-weight: 700; font-size: 1.15rem; border-top: 2px solid #cbd5e0; margin-top: 0.5rem; }
		.total-row { padding: 1.25rem 1.5rem; font-weight: 700; font-size: 1.3rem; border-radius: 8px; margin: 1rem 0; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
		.total-row.gross-profit { background: linear-gradient(135deg, #bee3f8 0%, #90cdf4 100%); color: #2c5282; }
		.total-row.net-profit { background: linear-gradient(135deg, #48bb78 0%, #38a169 100%); color: white; font-size: 1.5rem; padding: 1.5rem; margin-top: 2rem; }
        .total-row.net-loss { background: linear-gradient(135deg, #f56565 0%, #c53030 100%); color: white; font-size: 1.5rem; padding: 1.5rem; margin-top: 2rem; }
		
        .filter-section { background: #f8f9fa; padding: 1.5rem; border-radius: 8px; margin-bottom: 1.5rem; }
		.print-btn { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none; color: white; }
		.company-header { text-align: center; margin-bottom: 2rem; }
		.company-name { font-size: 1.8rem; font-weight: 700; color: #2d3748; margin-bottom: 0.5rem; }
		.report-title { font-size: 1.4rem; font-weight: 600; color: #4a5568; margin-bottom: 0.25rem; }
		.report-date { font-size: 1.1rem; color: #718096; }
		@media print {
			.sidebar, .main-header, .print-btn, .no-print, .filter-section { display: none !important; }
			.main-panel { width: 100% !important; margin: 0 !important; }
			.pl-card { box-shadow: none; }
		}
	</style>
</head>
<body>
	<div class="wrapper">
		<div class="main-header">
			<div class="logo-header">
				<a href="/admin/dashboard" class="logo">
					MaryBill Conglomerate
				</a>
				<button class="navbar-toggler sidenav-toggler ml-auto" type="button" data-toggle="collapse"
					data-target="collapse" aria-controls="sidebar" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
				<button class="topbar-toggler more"><i class="la la-ellipsis-v"></i></button>
			</div>
			<nav class="navbar navbar-header navbar-expand-lg">
				<div class="container-fluid">

					<form class="navbar-left navbar-form nav-search mr-md-3" action="">
						<div class="input-group">
							<input type="text" placeholder="Search ..." class="form-control">
							<div class="input-group-append">
								<span class="input-group-text">
									<i class="la la-search search-icon"></i>
								</span>
							</div>
						</div>
					</form>
					<ul class="navbar-nav topbar-nav ml-md-auto align-items-center">
						<li class="nav-item dropdown hidden-caret">
							<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown"
								aria-haspopup="true" aria-expanded="false">
								<i class="la la-envelope"></i>
							</a>
						</li>
						<li class="nav-item dropdown">
							<a class="dropdown-toggle profile-pic" data-toggle="dropdown" href="#" aria-expanded="false"> <img
									src="/img/profile-icon.png" alt="user-img" width="36" class="img-circle"><span>Steven</span></span>
							</a>
							<ul class="dropdown-menu dropdown-user">
								<li>
									<div class="user-box">
										<div class="u-img"><img src="/img/profile-icon.png" alt="user"></div>
										<div class="u-text">
											<h4>Steven</h4>
											<p class="text-muted">hello@themekita.com</p><a href="#"
												class="btn btn-rounded btn-danger btn-sm">View Profile</a>
										</div>
									</div>
								</li>
								<div class="dropdown-divider"></div>
								<a class="dropdown-item" href="#"><i class="ti-user"></i> My Profile</a>
								<a class="dropdown-item" href="#"></i> My Balance</a>
								<a class="dropdown-item" href="#"><i class="ti-email"></i> Inbox</a>
								<div class="dropdown-divider"></div>
								<a class="dropdown-item" href="#"><i class="ti-settings"></i> Account Setting</a>
								<div class="dropdown-divider"></div>
								<a class="dropdown-item" href="/logout"><i class="fa fa-power-off"></i> Logout</a>
							</ul>
							<!-- /.dropdown-user -->
						</li>
					</ul>
				</div>
			</nav>
		</div>
        <!-- Sidebar -->
		 <div class="sidebar">
  <div class="sidebar-wrapper">
    <div class="user">
      <div class="photo">
        <img src="/img/profile-icon.png" />
      </div>
      <div class="info">
        <a
          class=""
          data-toggle="collapse"
          href="#collapseExample"
          aria-expanded="true"
        >
          <span>
            Steven
            <span class="user-level">Administrator</span>
            <span class="caret"></span>
          </span>
        </a>
        <div class="clearfix"></div>

        <div class="collapse in" id="collapseExample" aria-expanded="true">
          <ul class="nav">
            <li>
              <a href="#profile">
                <span class="link-collapse">My Profile</span>
              </a>
            </li>
            <li>
              <a href="#edit">
                <span class="link-collapse">Edit Profile</span>
              </a>
            </li>
            <li>
              <a href="#settings">
                <span class="link-collapse">Settings</span>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <ul class="nav">
      <li class="nav-item">
        <a href="/admin/dashboard">
          <i class="fa-solid fa-gauge"></i>
          <p>Dashboard</p>
        </a>
      </li>
      <li class="nav-item">
        <a href="/admin/product-upload">
          <i class="fa-solid fa-upload"></i>
          <p>Upload Product</p>
        </a>
      </li>
      <li class="nav-item">
        <a href="/admin/all-products">
          <i class="fa-solid fa-tarp"></i>
          <p>All Products</p>
        </a>
      </li>
      <li class="nav-item">
        <a href="/staff/add">
          <i class="fa-solid fa-user-plus"></i>
          <p>Add Staff</p>
        </a>
      </li>
      <li class="nav-item">
        <a href="/staff/all">
          <i class="fa-solid fa-users"></i>
          <p>All Staff</p>
        </a>
      </li>
      <li class="nav-item">
        <a href="/payroll/setup">
          <i class="fa-solid fa-money-check-dollar"></i>
          <p>Payroll Config</p>
        </a>
      </li>
      <li class="nav-item">
        <a href="/payroll/run">
          <i class="fa-solid fa-play"></i>
          <p>Run Payroll</p>
        </a>
      </li>
      <li class="nav-item">
        <a href="/payroll/history">
          <i class="fa-solid fa-file-invoice-dollar"></i>
          <p>Payroll History</p>
        </a>
      </li>
      <li class="nav-item">
        <a href="/attendance">
          <i class="fa-solid fa-clock"></i>
          <p>Attendance</p>
        </a>
      </li>
      <li class="nav-item">
        <a href="/leave/manage">
          <i class="fa-solid fa-calendar-check"></i>
          <p>Leave Mgmt</p>
        </a>
      </li>
      
      <li class="nav-item">
        <a href="/customers">
          <i class="fa-solid fa-users-viewfinder"></i>
          <p>Customers</p>
        </a>
      </li>
      <li class="nav-item">
        <a href="/invoices">
          <i class="fa-solid fa-file-invoice"></i>
          <p>Invoices</p>
        </a>
      </li>
<li class="nav-item">
        <a href="/assets/add">
          <i class="fa-solid fa-box-archive"></i>
          <p>Add Asset</p>
        </a>
      </li>
      <li class="nav-item">
        <a href="/assets/all">
          <i class="fa-solid fa-boxes-stacked"></i>
          <p>All Assets</p>
        </a>
      </li>
      <li class="nav-item">
        <a href="/ledger/add">
          <i class="fa-solid fa-book"></i>
          <p>Ledger Entry</p>
        </a>
      </li>
      <li class="nav-item">
        <a href="/ledger/view">
          <i class="fa-solid fa-book-open"></i>
          <p>View Ledger</p>
        </a>
      </li>
      <li class="nav-item">
        <a href="/ledger/accounts">
          <i class="fa-solid fa-sitemap"></i>
          <p>Chart of Accounts</p>
        </a>
      </li>
      <li class="nav-item">
        <a href="/ledger/trial-balance">
          <i class="fa-solid fa-balance-scale"></i>
          <p>Trial Balance</p>
        </a>
      </li>
      <li class="nav-item">
        <a href="/ledger/balance-sheet">
          <i class="fa-solid fa-file-invoice-dollar"></i>
          <p>Balance Sheet</p>
        </a>
      </li>
      <li class="nav-item active">
        <a href="/ledger/profit-loss">
          <i class="fa-solid fa-money-bill-trend-up"></i>
          <p>Profit & Loss</p>
        </a>
      </li>
      <li class="nav-item">
        <a href="/logout">
          <i class="fas fa-sign-out-alt"></i>
          <p>Log Out</p>
        </a>
      </li>
    </ul>
  </div>
</div>
		<div class="main-panel">
			<div class="content">
				<div class="container-fluid">
					<div class="d-flex justify-content-between align-items-center mb-4 no-print">
						<h4 class="page-title mb-0"><i class="fa-solid fa-money-bill-trend-up"></i> <span class="text-primary">Profit & Loss Statement</span></h4>
						<button onclick="window.print()" class="btn print-btn"><i class="fa-solid fa-print"></i> Print</button>
					</div>

					<!-- Date Filter -->
					<div class="filter-section no-print">
						<form method="GET" action="/ledger/profit-loss">
							<div class="row">
								<div class="col-md-4">
									<div class="form-group">
										<label><strong>Start Date</strong></label>
										<input type="date" class="form-control" name="startDate" value="<%= report.startDate %>" required>
									</div>
								</div>
                                <div class="col-md-4">
									<div class="form-group">
										<label><strong>End Date</strong></label>
										<input type="date" class="form-control" name="endDate" value="<%= report.endDate %>" required>
									</div>
								</div>
								<div class="col-md-2">
									<div class="form-group">
										<label>&nbsp;</label>
										<button type="submit" class="btn btn-primary"><i class="fa-solid fa-filter"></i> Apply Filter</button>
									</div>
								</div>
							</div>
						</form>
					</div>

					<!-- Company Header -->
					<div class="company-header">
						<div class="company-name">MaryBill Conglomerate Ltd.</div>
						<div class="report-title">Profit & Loss Statement</div>
						<div class="report-date">
                            <%= new Date(report.startDate).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }) %> 
                            - 
                            <%= new Date(report.endDate).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }) %>
                        </div>
					</div>

					<!-- P&L Content -->
					<div class="row">
						<div class="col-md-12">
							<div class="card pl-card">
								<div class="card-body p-0">
									
                                    <!-- REVENUE SECTION -->
									<div class="section-header revenue">
										<i class="fa-solid fa-cash-register"></i> REVENUE
									</div>
									<% if (report.revenue.accounts.length > 0) { %>
										<% report.revenue.accounts.forEach(account => { %>
											<div class="account-row">
												<div>
													<span class="account-name"><%= account.accountName %></span>
													<span class="account-code">(<%= account.accountCode %>)</span>
												</div>
												<div class="account-amount">₦<%= account.net.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) %></div>
											</div>
										<% }); %>
									<% } else { %>
										<div class="account-row">
											<div class="text-muted">No revenue recorded</div>
											<div class="account-amount">₦0.00</div>
										</div>
									<% } %>
									<div class="subtotal-row d-flex justify-content-between">
										<span>Total Revenue</span>
										<span>₦<%= report.revenue.total.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) %></span>
									</div>

									<!-- COGS SECTION -->
									<div class="section-header cogs mt-4">
										<i class="fa-solid fa-boxes-stacked"></i> COST OF GOODS SOLD
									</div>
									<% if (report.cogs.accounts.length > 0) { %>
										<% report.cogs.accounts.forEach(account => { %>
											<div class="account-row">
												<div>
													<span class="account-name"><%= account.accountName %></span>
													<span class="account-code">(<%= account.accountCode %>)</span>
												</div>
												<div class="account-amount">₦<%= account.net.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) %></div>
											</div>
										<% }); %>
									<% } else { %>
										<div class="account-row">
											<div class="text-muted">No cost of goods sold recorded</div>
											<div class="account-amount">₦0.00</div>
										</div>
									<% } %>
									<div class="subtotal-row d-flex justify-content-between">
										<span>Total COGS</span>
										<span>₦<%= report.cogs.total.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) %></span>
									</div>

                                    <!-- GROSS PROFIT -->
                                    <div class="total-row gross-profit d-flex justify-content-between mt-3">
										<span>GROSS PROFIT</span>
										<span>₦<%= report.grossProfit.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) %></span>
									</div>

									<!-- OPERATING EXPENSES SECTION -->
									<div class="section-header expenses mt-4">
										<i class="fa-solid fa-receipt"></i> OPERATING EXPENSES
									</div>
									<% if (report.expenses.accounts.length > 0) { %>
										<% report.expenses.accounts.forEach(account => { %>
											<div class="account-row">
												<div>
													<span class="account-name"><%= account.accountName %></span>
													<span class="account-code">(<%= account.accountCode %>)</span>
												</div>
												<div class="account-amount">₦<%= account.net.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) %></div>
											</div>
										<% }); %>
									<% } else { %>
										<div class="account-row">
											<div class="text-muted">No operating expenses recorded</div>
											<div class="account-amount">₦0.00</div>
										</div>
									<% } %>
									<div class="subtotal-row d-flex justify-content-between">
										<span>Total Operating Expenses</span>
										<span>₦<%= report.expenses.total.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) %></span>
									</div>

									<!-- NET PROFIT -->
									<div class="total-row <%= report.netProfit >= 0 ? 'net-profit' : 'net-loss' %> d-flex justify-content-between">
										<span><i class="<%= report.netProfit >= 0 ? 'fa-solid fa-arrow-trend-up' : 'fa-solid fa-arrow-trend-down' %>"></i> NET <%= report.netProfit >= 0 ? 'PROFIT' : 'LOSS' %></span>
										<span>₦<%= report.netProfit.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) %></span>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<%- include('./partials/responseMessage') %>
	<script src="/js/core/jquery.3.2.1.min.js"></script>
	<script src="/js/plugin/jquery-ui-1.12.1.custom/jquery-ui.min.js"></script>
	<script src="/js/core/popper.min.js"></script>
	<script src="/js/core/bootstrap.min.js"></script>
	<script src="/iziToast-master/dist/js/iziToast.min.js"></script>
	<script src="/js/plugin/jquery-scrollbar/jquery.scrollbar.min.js"></script>
	<script src="/js/ready.min.js"></script>
	<script src="/js/toast.js"></script>
</body>
</html>
